$(function(){function n(n){return function(i,e){var t=i[n];return e[n]-t}}!function(){var i=localStorage.getItem("Count");if(console.log(i),console.log(typeof i),1==i)$.ajax({type:"POST",async:!1,error:function(n){console.log("首次进入路由设置界面失败")},success:function(n){console.log("首次进入路由设置界面成功");var i=JSON.parse(n);wifiObj=i.Chosen,$("#wifiName>.title-name").text(i.Chosen.ssid),$("#wifiPwd").val(i.Chosen.wifiPassword),$("#signalStrength").val(i.Chosen.signal),$("#encrypt").val(i.Chosen.security),$("#mac").val(i.Chosen.mac)}});else{var e=localStorage.getItem("OtherChosen");wifiObj=e,$("#wifiName>.title-name").text(e.ssid),$("#wifiPwd").val(e.wifiPwd),$("#signalStrength").val(e.signal),$("#encrypt").val(e.security),$("#mac").val(e.mac)}i>1&&(i=2),localStorage.setItem("Count",i);var t=localStorage.getItem("scanWifi");scanEntity=JSON.parse(t),console.log(t);var c=scanEntity.Scan;c.sort(n("signal")),console.log(scanEntity.Scan);var o=template("listTmp",scanEntity);$("#selectCon").html(o),console.log("点击下拉按钮之前渲染本地数据到页面成功"),console.log($("#selectCon").html()),$.each(c,function(n,i){$.each(c[n],function(i,e){if(""===c[n][i]&&(console.log("不合法的wifi信息数据-------d"),console.log(n),console.log(c)),("security"===i&&"OPEN"===e||"security"===i&&"NONE"===e)&&$("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(1)").css("display","none"),"signal"===i)switch(!0){case e>=75:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_01.png"),!1;case e>=50:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_02.png"),!1;case e>=25:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_03.png"),!1;case e>=0:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_04.png"),!1}})});var l=JSON.stringify(scanEntity);localStorage.setItem("scanWifi",l),console.log(localStorage)}(),wifiData="Channel="+wifiObj.Channel+"&ssid="+wifiObj.ssid+"&bssid="+wifiObj.bssid+"&security="+wifiObj.security+"&signal="+wifiObj.signal+"&mode="+wifiObj.mode+"&ext_ch="+wifiObj.ext_ch+"&net_type="+wifiObj.net_type+"&wps="+wifiObj.wps,console.log("成功获取被点击的wifi的相关信息："+wifiData),$("header>.nav-back").on("click",function(){window.history.go(-1)}),$("#wifiName>.wifi-r>.list-btn").on("click",function(n){var i=localStorage.getItem("scanWifi");scanEntity=JSON.parse(i),console.log(scanEntity);var e=scanEntity.Scan;$.each(e,function(n,i){$.each(e[n],function(i,e){if("signal"===i)switch(console.log(e),!0){case e>=75:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_01.png"),!1;case e>=50:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_02.png"),!1;case e>=25:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_03.png"),!1;case e>=0:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_04.png"),!1}("security"===i&&"OPEN"===e||"security"===i&&"NONE"===e)&&$("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(1)").css("display","none")})}),n.stopPropagation(),$("#selectCon").select()}),$("#wifiName>.wifi-r>.refresh-btn").on("click",function(i){$.ajax({url:"/cgi-bin/wifi_setting.cgi",type:"POST",data:"wifiScan=Scan",async:!1,success:function(i){response=JSON.parse(i),console.log("11111111111111111");var e=response.Scan;e.sort(n("signal"));console.log(e),console.log(response.Scan),console.log(response);var t=template("listTmp",response);$("#selectCon").html(t),console.log(t),console.log("将模板数据渲染到页面成功"),$.each(e,function(n,i){$.each(e[n],function(i,e){if("signal"===i)switch(console.log(e),!0){case e>=75:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_01.png"),!1;case e>=50:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_02.png"),!1;case e>=25:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_03.png"),!1;case e>=0:return $("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(2)").attr("src","images/02_icon03_04.png"),!1}("security"===i&&"OPEN"===e||"security"===i&&"NONE"===e)&&$("#selectCon>ul>li:nth-child("+(n+1)+")>img:nth-child(1)").css("display","none")})});var c=JSON.stringify(response);localStorage.setItem("scanWifi",c),console.log(localStorage),console.log("刷新按钮获取服务器的wifi列表数据成功")}}),i.stopPropagation(),$(".selectContainer").select()}),$("#main>form>button>a").on("click",function(){return layer.open({title:["提示","background-color:#438cff; color:#fff;"],anim:"up",content:"是否前往修改扩展WiFi信息？",btn:["确定","取消"],yes:function(n){var i=$("#wifiPwd").val();$.ajax({type:"POST",data:"routeInfo=route&routePwd="+routePwd+"&"+wifiData,error:function(n){console.log("提交当前路由设置信息失败")},success:function(n){console.log(n),console.log("提交当前路由设置信息成功");var e=wifiData;e.wifiPwd=i,localStorage.setItem("OtherChosen",e),"routeSucess"==n&&(window.location.href="manage_WiFi_setting.html")}})},no:function(n){window.location.href="syetem_reboot_progress.html"},success:function(n){console.log(n),$(".layui-m-layersection>.layui-m-layerchild").append("<div class='popup-close'></div>"),$(".layui-m-layersection>.layui-m-layerchild>.popup-close").on("click",function(){$(n).css({display:"none"})})}}),!1})});