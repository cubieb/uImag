$(function(){function i(i){return function(n,e){var t=n[i];return e[i]-t}}!function(){var n=localStorage.getItem("scanWifi");scanEntity=JSON.parse(n),console.log(n),console.log(scanEntity);var e=scanEntity.Scan;e.sort(i("signal")),console.log(e),console.log(scanEntity.Scan),console.log(scanEntity);var t=template("listTmp",scanEntity);$("#selectCon").html(t),console.log("点击下拉按钮之前渲染本地数据到页面成功"),console.log($("#selectCon").html()),$.each(e,function(i,n){$.each(e[i],function(n,t){if(""===e[i][n]&&(console.log("不合法的wifi信息数据-------d"),console.log(i),console.log(e)),("security"===n&&"OPEN"===t||"security"===n&&"NONE"===t)&&$("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(1)").css("display","none"),"signal"===n)switch(!0){case t>=75:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_01.png"),!1;case t>=50:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_02.png"),!1;case t>=25:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_03.png"),!1;case t>=0:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_04.png"),!1}})});var s=JSON.stringify(scanEntity);localStorage.setItem("scanWifi",s),console.log(localStorage),console.log("刷新按钮获取服务器的wifi列表数据成功")}(),$("#wifi-list>.wifi-name>.wifi-l").text(scanEntity.Scan[0].ssid),$("#wifi-list>.wifi-password>input[type='text']").attr("placeholder",'请输入"'+scanEntity.Scan[0].ssid+'"的密码'),wifiObj=scanEntity.Scan[0],wifiData="Channel="+wifiObj.Channel+"&ssid="+wifiObj.ssid+"&bssid="+wifiObj.bssid+"&security="+wifiObj.security+"&signal="+wifiObj.signal+"&mode="+wifiObj.mode+"&ext_ch="+wifiObj.ext_ch+"&net_type="+wifiObj.net_type+"&wps="+wifiObj.wps,console.log("成功获取被点击的wifi的相关信息："+wifiData),ssidName=wifiObj.ssid,console.log("获取了被点击的wifi名:"+ssidName),$("#wifi-list>.wifi-amplifier>#newWifiName").val(ssidName+"-Plus"),$("#wifi-list>.amplifier-password>#newPassword").attr("placeholder","请输入"+ssidName+"-Plus的密码"),$("#wifi-list>.wifi-password>input[type='text']").on("input",function(){$("#wifi-list>.amplifier-password>#newPassword").val($("#wifi-list>.wifi-password>input[type='text']").val())}),$("#wifi-list>.wifi-amplifier>#newWifiName").on("input",function(){$("#wifi-list>.amplifier-password>#newPassword").attr("placeholder","请输入"+$("#wifi-list>.wifi-amplifier>#newWifiName").val()+"的密码")}),$("header>.nav-back").on("click",function(){window.history.go(-1)}),$("#wifi-list>.wifi-name>.wifi-r>.list-btn").on("click",function(i){var n=localStorage.getItem("scanWifi");scanEntity=JSON.parse(n),console.log(scanEntity);var e=scanEntity.Scan;$.each(e,function(i,n){$.each(e[i],function(n,e){if("signal"===n)switch(console.log(e),!0){case e>=75:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_01.png"),!1;case e>=50:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_02.png"),!1;case e>=25:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_03.png"),!1;case e>=0:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_04.png"),!1}("security"===n&&"OPEN"===e||"security"===n&&"NONE"===e)&&$("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(1)").css("display","none")})}),i.stopPropagation(),$("#selectCon").select()}),$("#wifi-list>.wifi-name>.wifi-r>.refresh-btn").on("click",function(n){$.ajax({url:"/cgi-bin/wifi_setting.cgi",type:"POST",data:"wifiScan=Scan",async:!1,success:function(n){response=JSON.parse(n),console.log("11111111111111111");var e=response.Scan;e.sort(i("signal"));console.log(e),console.log(response.Scan),console.log(response);var t=template("listTmp",response);$("#selectCon").html(t),console.log(t),console.log("将模板数据渲染到页面成功"),$.each(e,function(i,n){$.each(e[i],function(n,e){if("signal"===n)switch(console.log(e),!0){case e>=75:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_01.png"),!1;case e>=50:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_02.png"),!1;case e>=25:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_03.png"),!1;case e>=0:return $("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(2)").attr("src","images/02_icon03_04.png"),!1}("security"===n&&"OPEN"===e||"security"===n&&"NONE"===e)&&$("#selectCon>ul>li:nth-child("+(i+1)+")>img:nth-child(1)").css("display","none")})});var s=JSON.stringify(response);localStorage.setItem("scanWifi",s),console.log(localStorage),console.log("刷新按钮获取服务器的wifi列表数据成功")}}),n.stopPropagation(),$(".selectContainer").select()}),$("#wifi-form>#wifi-list>.same-password>.cBox").on("click",function(){$(this).find("input[type='checkbox']").prop("checked")?$("#wifi-list>.password-management").hide(300):$("#wifi-list>.password-management").show(300)}),$("#wifi-form").validate({rules:{wifiPassword:{emptyCheck:!0,manageCodeCheck:!0,remote:{url:"/cgi-bin/wifi_setting.cgi",type:"POST",data:{mainpasswd:"ckpwd",wifiPassword:function(){return $("#wifiPassword").val()},Channel:function(){return wifiObj.Channel},ssid:function(){return wifiObj.ssid},security:function(){return wifiObj.security}}}},newWifiName:{emptyCheck:!0,minlength:1,maxlength:26},newPassword:{emptyCheck:!0,manageCodeCheck:!0},managePassword:{emptyCheck:!0,manageCodeCheck:!0}},messages:{wifiPassword:{emptyCheck:"输入不能为空",manageCodeCheck:"有效密码为8-64位字符",remote:"密码输入不正确"},newWifiName:{emptyCheck:"输入不能为空"},newPassword:{emptyCheck:"输入不能为空",manageCodeCheck:"有效密码为8-64位字符"},managePassword:{emptyCheck:"输入不能为空",manageCodeCheck:"有效密码为8-64位字符"}},success:function(i){i.parent().parent().css({"border-color":"#ddd"})},errorPlacement:function(i,n){console.log(n),console.log(i),i.appendTo(n.siblings("p")),n.parent().css({"border-color":"#EE2222"})}}),$("#wifi-form>#wifi-list>#next-bnt").click(function(){var i=$("#wifi-form").valid();console.log(i),i&&$.ajax({type:"POST",url:"/cgi-bin/wifi_setting.cgi",data:"wifiCommit=commit&"+wifiData+"&"+$("#wifi-form").serialize(),error:function(i){console.log("提交表单失败服务端返回的数据"+i),console.log("Connection error"),console.log("提交表单数据失败")},success:function(i){console.log("提交表单数据成功后服务端返回的数据"+i),console.log("提交表单数据成功"),window.location.href="configuration.html"}})})});